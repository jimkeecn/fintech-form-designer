@if(form){
<ng-container [formGroup]="form">
    <ng-content select="[description]"></ng-content>
    <div class="tw-flex tw-flex-col tw-gap-2">
        <p-dropdown
            [options]="allFields"
            placeholder="Select a field"
            formControlName="selectedField"
            optionLabel="value.key"
            [showClear]="true"
            class="tw-flex tw-flex-col"
        >
            <ng-template let-field pTemplate="item">
                <div class="tw-flex tw-justify-between tw-items-center">
                    <div class="tw-text-base">{{ field.value.key }}</div>
                    <div
                        class="tw-border-none tw-bg-slate-700 tw-text-white tw-p-2 tw-w-[100px] tw-text-xs tw-text-center tw-rounded-md"
                    >
                        {{ fieldTypeMapper(field.value ? field.value.type : '') }}
                    </div>
                </div>
            </ng-template>
        </p-dropdown>
        <ng-content select="[form]"></ng-content>
        <p-button label="Add" size="small" (onClick)="addAction([form.get('selectedField')?.value, action])" />
    </div>
    <p-divider></p-divider>
    <div class="tw-flex tw-flex-col tw-gap-3">
        @for(field of form.get('actions')?.value;track field.key){
        <div class="tw-flex tw-justify-between tw-items-center">
            <div class="tw-flex tw-flex-col tw-gap-1">
                <label class="tw-text-xs">Target Field</label>
                <p>{{ field.key }}</p>
            </div>
            <ng-content select="[actions]"></ng-content>
            <p-button icon="pi pi-times" severity="danger" size="small" (onClick)="removeAction([field, action])" />
        </div>
        }
    </div>
</ng-container>
}
